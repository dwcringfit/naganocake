<% if @cart_item.present? %>
  <%= render "layouts/error_messages", model: @cart_item %>
<% end %>


<div class="row">
	<div class="col-md-4">
	    <h3>ショッピングカート</h3>
	</div>
	<div class="col-md-offset-6 col-md-2">
	    <h3><%= link_to "カートを空にする", destroy_all_cart_items_path, method: :delete, data: {confirm: "本当にカートを空にしてもよろしいですか？"}, class: "btn btn-danger" %></h3>
    </div>
</div>

<div class="row">
    <table class="table table-bordered">
        <thead>
		    <tr>
			    <th>商品名</th>
		        <th>単価(税込)</th>
			    <th>数量</th>
			    <th>小計</th>
			    <th></th>
		    </tr>
	    </thead>
		<tbody>
			<% if @cart_items.present? %>
		        <% @cart_items.each do |cart_item| %>
		            <tr>
			            <td><%= attachment_image_tag(@item, :image, format: 'jpeg', size: '100x100', fallback: "no_image.jpg") %>
			                <%= cart_item.item.name %></td>
			            <td><%= cart_item.item.price_tax_included %></td>
			            <td><%= form_for(cart_item) do |f| %>
			                <%= f.number_field :item_count, placeholder: "#{cart_item.item_count}" %>
			                <%= f.submit "変更" , class: "btn btn-primary" %>
			                <% end %></td>
			            <td><%= cart_item.subtotal %></td>
			            <td><%= link_to "削除する", cart_item_path(cart_item.item_id), method: :delete, class: "btn btn-danger" %></td>
		            </tr>
		        <% end %>
		    <% end %>
		</tbody>
	</table>
</div>

<div class="row">
	<div class="col-md-3">
	    <%= link_to "買い物を続ける", root_path, class: "btn btn-primary" %>
    </div>
    <div class="item_total_amount col-md-offset-6 col-md-2">
	    <p>合計金額</p>
    </div>
    <div class="item_total_amount col-md-1">
    	<p><%= @item_total_amount %></p>
    </div>
</div>


<div class="row">
	<div class="col-md-4 col-md-offset-4">
	    <% if @cart_items.present? %>
            <%= link_to "情報入力に進む", new_order_path, class: "btn btn-success btn-block" %>
        <% end %>
    </div>
</div>

